<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Spacetime interaction models</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for inla.knmodels {INLA}"><tr><td>inla.knmodels {INLA}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Spacetime interaction models</h2>

<h3>Description</h3>

<p>It implements the models in Knorr-Held, L. (2000) with three different
constraint approaches: sum-to-zero, contrast or diagonal add.
</p>


<h3>Usage</h3>

<pre>
inla.knmodels(
  formula,
  progress = FALSE,
  control.st = list(time, space, spacetime, graph, type = c(paste(1:4), paste0(2:4,
    "c"), paste0(2:4, "d")), diagonal = 1e-05, timeref = 1, spaceref = 1, ...),
  ...
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>
<p>The formula specifying the other model components, without
the spacetime interaction term. The spacetime interaction term will be added
accordly to the specification in the <code>control.st</code> argument. See
<code>inla</code></p>
</td></tr>
<tr valign="top"><td><code>progress</code></td>
<td>
<p>If it is to be shown the model fitting progress. Useful if
more than one interaction type is being fitted.</p>
</td></tr>
<tr valign="top"><td><code>control.st</code></td>
<td>
<p>Named list of arguments to control the spacetime
interaction. It should contain:
</p>

<dl>
<dt>time</dt><dd><p>to be used as the
index set for the main temporal effect which will be considered for the
constraints when it is the case.</p>
</dd>
<dt>space</dt><dd><p>to be used as the index set
for the main spatial effect which will be considered for the constraints
when it is the case.</p>
</dd>
<dt>spacetime</dt><dd><p>to be the index set for the spacetime
interaction effect.</p>
</dd>
<dt>graph</dt><dd><p>to be the graph for the spatial neighbor
structure to be used in a <code><a href="../../INLA/help/f.html">f</a></code> term for the main spatial random
effect term or for building the spacetime interaction model.</p>
</dd>
<dt>type</dt><dd><p>to
specify the spacetime interaction type.  <code>1</code> to <code>4</code> corresponds to
the four interaction types in Knorr-Held, L. (2000) with all the needed
sum-to-zero constraints.  <code>2c</code>, <code>3c</code> and <code>4c</code> are the
contrast version considering the first time or space constrained to be equal
to zero.  <code>2d</code>, <code>3d</code> and <code>4d</code> are the corresponding versions
when considering the diagonal add approach.</p>
</dd>
<dt>diagonal</dt><dd><p>to be the value
to be added to the diagonal when using the diagonal add approach.</p>
</dd>
<dt>timeref</dt><dd><p>to specify the time point to be the reference time in the
contrast parametrization.</p>
</dd>
<dt>spaceref</dt><dd><p>to specify the area to be the
reference for the contrast parametrization.</p>
</dd>
<dt>...</dt><dd><p>where additional
arguments can be passed to <code><a href="../../INLA/help/f.html">f</a></code> function.  Specification of the
hyperparameter, fixed or random, initial value, prior and its parameters for
the spacetime interaction. See <code>?inla.models</code> and look for
<code>generic0</code>.  By default we scale it and use the PC-prior to set the
prior using the <code>pc.prec</code> prior with <code>param = c(0.5, 0.5)</code>. See
documentation with <code>?inla.doc("pc.prec")</code>.</p>
</dd> </dl>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p>Arguments to be passed to the <code><a href="../../INLA/help/inla.html">inla</a></code> function.</p>
</td></tr>
</table>


<h3>Value</h3>

<p><code>inla.knmodels</code> returns an object of class <code>"inla"</code>.  or a
list of objects of this class if it is asked to compute more than one
interaction type at once.  Note: when the model type is 2c, 3c, 4c, 2d, 3d
or 4d, it also includes linear combinations summary.
</p>


<h3>Author(s)</h3>

<p>Elias T. Krainski
</p>


<h3>See Also</h3>

<p><code><a href="../../INLA/help/inla.knmodels.sample.html">inla.knmodels.sample</a></code> to sample from
</p>


<h3>Examples</h3>

<pre>

### define space domain as a grid
grid &lt;- SpatialGrid(GridTopology(c(0,0), c(1, 1), c(4, 5)))
(n &lt;- nrow(xy &lt;- coordinates(grid)))

### build a spatial neighborhood list
jj &lt;- lapply(1:n, function(i)
    which(sqrt((xy[i,1]-xy[,1])^2 + (xy[i,2]-xy[,2])^2)==1))

### build the spatial adjacency matrix
graph &lt;- sparseMatrix(rep(1:n, sapply(jj, length)),
                      unlist(jj), x=1, dims=c(n, n))

### some random data at 10 time point
dat &lt;- inla.knmodels.sample(graph, m=10, tau.t=2, tau.s=2, tau.st=3)
str(dat)
sapply(dat$x, summary)

nd &lt;- length(dat$x$eta)
dat$e &lt;- runif(nd, 0.9, 1.1)*rgamma(n, 40, 2)
dat$y &lt;- rpois(nd, dat$e*exp(dat$x$eta-3))
summary(dat$y)

### fit the type 4 considering three different approaches
tgraph &lt;- sparseMatrix(i=c(2:10, 1:9), j=c(1:9, 2:10), x=1)
res &lt;- inla.knmodels(y ~ f(time, model='bym2', graph=tgraph) +
     f(space, model='bym2', graph=graph),
     data=dat, family='poisson', E=dat$E, progress=TRUE,
     control.st=list(time=time, space=space,
        spacetime=spacetime, graph=graph, type=c(4, '4c', '4d')),
     control.compute=list(dic=TRUE, waic=TRUE, cpo=TRUE))
sapply(res, function(x)
       c(dic=x$dic$dic, waic=x$waic$waic, cpo=-sum(log(x$cpo$cpo))))

</pre>

<hr /><div style="text-align: center;">[Package <em>INLA</em> version 22.02.16-2 <a href="00Index.html">Index</a>]</div>
</div></body></html>
