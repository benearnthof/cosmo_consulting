<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Bayesian analysis of structured additive models</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for inla {INLA}"><tr><td>inla {INLA}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Bayesian analysis of
structured additive models</h2>

<h3>Description</h3>

<p><code>inla</code> performs a
full Bayesian analysis of additive models using Integrated Nested
Laplace approximation
</p>


<h3>Usage</h3>

<pre>
 inla(
    formula = NULL,
    family = "gaussian",
    contrasts = NULL,
    data = NULL,
    quantiles=c(0.025, 0.5, 0.975),
    E = NULL,
    offset=NULL,
    scale = NULL,
    weights = NULL,
    Ntrials = NULL,
    strata = NULL,
    link.covariates = NULL,
    verbose = FALSE,
    lincomb = NULL,
    selection = NULL,
    lp.scale = NULL,
    control.compute = list(),
    control.predictor = list(),
    control.family = list(),
    control.inla = list(),
    control.fixed = list(),
    control.mode = list(),
    control.expert = list(),
    control.hazard = list(),
    control.lincomb = list(),
    control.update = list(),
    control.lp.scale = list(),
    control.pardiso = list(),
    only.hyperparam = FALSE,
    inla.call = inla.getOption("inla.call"),
    inla.arg = inla.getOption("inla.arg"),
    num.threads = inla.getOption("num.threads"),
    blas.num.threads = inla.getOption("blas.num.threads"),
    keep = inla.getOption("keep"),
    working.directory = inla.getOption("working.directory"),
    silent = inla.getOption("silent"),
    inla.mode = inla.getOption("inla.mode"), 
    safe = FALSE, 
    debug = inla.getOption("debug"),
    .parent.frame = parent.frame()
    )
 </pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>formula</code></td>
<td>
<p> A <code>inla</code> formula like <code>y
 ~1 + z + f(ind, model="iid")</code> + f(ind2,
weights, model=&quot;ar1&quot;) This is much like the formula
for a <code>glm</code> except that smooth or spatial terms
can be added to the right hand side of the formula.
See <code><a href="../../INLA/help/f.html">f</a></code> for full details and the web site
<a href="www.r-inla.org">www.r-inla.org</a> for several worked out
examples. Each smooth or spatial term specified
through <code>f</code> should correspond to separate column
of the data frame <code>data</code>.
The response
variable, <code>y</code> can be a univariate response
variable, a list or the output of the function
<code>inla.surf</code> for survival analysis models.</p>
</td></tr>
<tr valign="top"><td><code>family</code></td>
<td>
<p> A string indicating the likelihood
family. The default is <code>gaussian</code> with identity
link. See <code>names(inla.models()$likelihood)</code> for a
list of possible alternatives and use <code><a href="../../INLA/help/inla.doc.html">inla.doc</a></code>
for detailed docs for individual families.</p>
</td></tr>
<tr valign="top"><td><code>contrasts</code></td>
<td>
<p>Optional contrasts for the fixed
effects; see <code>?lm</code> or <code>?glm</code> for details.</p>
</td></tr>
<tr valign="top"><td><code>data</code></td>
<td>
<p> A data frame or list containing the
variables in the model.  The data frame MUST be
provided</p>
</td></tr>
<tr valign="top"><td><code>quantiles</code></td>
<td>
<p> A vector of quantiles,
<i>p(0), p(1),&hellip;</i> to compute
for each posterior marginal. The function returns,
for each posterior marginal, the values
<i>x(0), x(1),&hellip;</i> such that
</p>
<p style="text-align: center;"><i>Prob(X&lt;x)=p</i></p>
 </td></tr>
<tr valign="top"><td><code>E</code></td>
<td>
<p> Known component in the mean for the Poisson
likelihoods defined as </p>
<p style="text-align: center;"><i>E
 exp(eta)</i></p>
<p> where </p>
<p style="text-align: center;"><i>eta</i></p>
<p> is the linear
predictor. If not provided it is set to <code>rep(1, n.data)</code>.</p>
</td></tr>
<tr valign="top"><td><code>offset</code></td>
<td>
<p>This argument is used to specify an
a-priori known and fixed component to be included in
the linear predictor during fitting.  This should be
<code>NULL</code> or a numeric vector of length either one
or equal to the number of cases. One or more
<code>offset()</code> terms can be included in the formula
instead or as well, and if both are used, they are
combined into a common offset.  If the
<code>A</code>-matrix is used in the linear predictor
statement <code>control.predictor</code>, then the
<code>offset</code> given in this argument is added to
<code>eta*</code>, the linear predictor related to the
observations, as <code>eta* = A eta + offset</code>,
whereas an offset in the formula is added to
<code>eta</code>, the linear predictor related to the
formula, as <code>eta = ... + offset.formula</code>. So in
this case, the offset defined here and in the formula
has a different meaning and usage.</p>
</td></tr>
<tr valign="top"><td><code>scale</code></td>
<td>
<p> Fixed (optional) scale parameters of
the precision for Gaussian and Student-T response
models. Default value is rep(1, n.data).</p>
</td></tr>
<tr valign="top"><td><code>weights</code></td>
<td>
<p> Fixed (optional) weights parameters of
the likelihood, so the log-likelihood[i] is changed into
weights[i]*log-likelihood[i]. Default value is rep(1,
n.data). 
WARNING: The normalizing constant for the likelihood is NOT recomputed, so
ALL marginals (and the marginal likelihood) must be interpreted with great care.</p>
</td></tr>
<tr valign="top"><td><code>Ntrials</code></td>
<td>
<p>A vector containing the number of trials for the <code>binomial</code>
likelihood and variantes, or the number of required successes for the
<code>nbinomial2</code> likelihood. Default value is <code>rep(1, n.data)</code>.</p>
</td></tr>
<tr valign="top"><td><code>strata</code></td>
<td>
<p>Fixed (optional) strata indicators
for tstrata likelihood model.</p>
</td></tr>
<tr valign="top"><td><code>lp.scale</code></td>
<td>
<p> A vector with same length as the predictor going into the likelihood with
either <code>NA</code>'s or indices indexing the scaling coefficients. <code>NA</code> or a index less
or equal to 0 means no scaling. The priors and properties of the scaling coefficients are
set in <code>control.lp.scale</code> </p>
</td></tr>
<tr valign="top"><td><code>link.covariates</code></td>
<td>
<p>A vector or matrix with covariates for link functions</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>

<p>Boolean indicating if the <code>inla</code>-program should
run in a verbose mode (default <code>FALSE</code>).</p>
</td></tr>
<tr valign="top"><td><code>lincomb</code></td>
<td>
<p>Used to define linear combination of
nodes in the latent field. The posterior distribution
of such linear combination is computed by the
<code>inla</code> function. See
<a href="www.r-inla.org/faq">www.r-inla.org/faq</a> for examples of
how to define such linear combinations.</p>
</td></tr>
<tr valign="top"><td><code>selection</code></td>
<td>
<p> This is a similar argument to the one in
<code>inla.posterior.sample</code>  and follow the same format.
This argument allows to define a subset of the latent field
for which to compute an approximated joint
distribution. It will appear in <code>result$selection</code>.
See also <code>?inla.rjmarginal</code>. </p>
</td></tr>
<tr valign="top"><td><code>control.compute</code></td>
<td>
<p> See <code>?control.compute</code></p>
</td></tr>
<tr valign="top"><td><code>control.predictor</code></td>
<td>
<p> See
<code>?control.predictor</code></p>
</td></tr>
<tr valign="top"><td><code>control.family</code></td>
<td>
<p> See <code>?control.family</code></p>
</td></tr>
<tr valign="top"><td><code>control.inla</code></td>
<td>
<p> See <code>?control.inla</code></p>
</td></tr>
<tr valign="top"><td><code>control.fixed</code></td>
<td>
<p> See <code>?control.fixed</code></p>
</td></tr>
<tr valign="top"><td><code>control.mode</code></td>
<td>
<p> See <code>?control.mode</code></p>
</td></tr>
<tr valign="top"><td><code>control.expert</code></td>
<td>
<p> See <code>?control.expert</code></p>
</td></tr>
<tr valign="top"><td><code>control.hazard</code></td>
<td>
<p> See <code>?control.hazard</code></p>
</td></tr>
<tr valign="top"><td><code>control.lincomb</code></td>
<td>
<p> See <code>?control.lincomb</code></p>
</td></tr>
<tr valign="top"><td><code>control.update</code></td>
<td>
<p> See <code>?control.update</code></p>
</td></tr>
<tr valign="top"><td><code>control.lp.scale</code></td>
<td>
<p> See <code>?control.lp.scale</code></p>
</td></tr>
<tr valign="top"><td><code>control.pardiso</code></td>
<td>
<p> See <code>?control.pardiso</code></p>
</td></tr>
<tr valign="top"><td><code>only.hyperparam</code></td>
<td>
<p> A boolean variable saying if
only the hyperparameters should be computed. This option is mainly used
internally. (TODO: This option should not be located here,  change it!)</p>
</td></tr>
<tr valign="top"><td><code>inla.call</code></td>
<td>
<p> The path to, or the name of, the
<code>inla</code>-program. This is program is installed
together with the <code>R</code>-package, but, for example,
a native compiled version can be used instead to
improve the performance.</p>
</td></tr>
<tr valign="top"><td><code>inla.arg</code></td>
<td>
<p> A string indicating ALL arguments to
the 'inla' program and do not include default
arguments. (OOPS: This is an expert option!)</p>
</td></tr>
<tr valign="top"><td><code>num.threads</code></td>
<td>
<p> Maximum number of threads the
<code>inla</code>-program will use, or as 'A:B' defining the number threads in the
outer (A) and inner (B) layer for nested parallelism. </p>
</td></tr>
<tr valign="top"><td><code>blas.num.threads</code></td>
<td>
<p>The absolute value of <code>blas.num.threads</code> is the maximum
number of threads the the <code>openblas</code>/<code>mklblas</code> will use (if
available). Value is ignored if <code>&lt;=0</code> (then environment variables are used).</p>
</td></tr>
<tr valign="top"><td><code>keep</code></td>
<td>
<p> A boolean variable indicating that the
working files (ini file, data files and results
files) should be kept. If TRUE and no
<code>working.directory</code> is specified the working
files are stored in a directory called &quot;inla&quot;.  </p>
</td></tr>
<tr valign="top"><td><code>working.directory</code></td>
<td>
<p> A string giving the name
of an non-existing directory where to store the
working files.</p>
</td></tr>
<tr valign="top"><td><code>silent</code></td>
<td>
<p>If equal to 1L or TRUE, then the
<code>inla</code>-program would be &ldquo;silent&rdquo;. If equal to
2L, then supress also error messages from the
<code>inla</code>-program.</p>
</td></tr>
<tr valign="top"><td><code>inla.mode</code></td>
<td>
<p>Run <code>inla</code> in <code>classic</code>-mode,
<code>twostage</code>-mode or the new <code>experimental</code>-mode?
Not all features are available int the <code>experimental</code>-mode and this mode
is really work-in-progress at the moment!!!!
Default is to use the 
mode set by <code>inla.getOption("inla.mode")</code> which is default
<code>classic</code>-mode. </p>
</td></tr>
<tr valign="top"><td><code>safe</code></td>
<td>
<p> If <code>TRUE</code>, then enable possible restarts to improve initial values and
Hessian if needed. </p>
</td></tr>
<tr valign="top"><td><code>debug</code></td>
<td>
<p> If <code>TRUE</code>, then enable some debug
output.  </p>
</td></tr>
<tr valign="top"><td><code>.parent.frame</code></td>
<td>
<p>Internal use only</p>
</td></tr>
</table>


<h3>Value</h3>


<p><code>inla</code> returns an object of class <code>"inla"</code>. This is a list
containing at least the following arguments:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>summary.fixed</code></td>
<td>
<p>Matrix containing the mean and standard
deviation (plus, possibly quantiles and cdf) of the the fixed
effects of the model.</p>
</td></tr>
<tr valign="top"><td><code>marginals.fixed</code></td>
<td>

<p>A list containing the posterior marginal
densities of the fixed effects of the model.</p>
</td></tr>
<tr valign="top"><td><code>summary.random</code></td>
<td>
<p>List of matrices containing the mean and
standard deviation (plus, possibly quantiles and cdf) of the
the smooth or spatial effects defined through <code>f()</code>.</p>
</td></tr>
<tr valign="top"><td><code>marginals.random</code></td>
<td>
<p>A list containing the
posterior marginal densities of the random effects defined
through <code>f</code>.</p>
</td></tr>
<tr valign="top"><td><code>summary.hyperpar</code></td>
<td>

<p>A matrix containing the mean and sd
(plus, possibly quantiles and cdf) of the hyperparameters of
the model </p>
</td></tr>
<tr valign="top"><td><code>marginals.hyperpar</code></td>
<td>

<p>A list containing the posterior marginal
densities of the hyperparameters of the model.</p>
</td></tr>
<tr valign="top"><td><code>summary.linear.predictor</code></td>
<td>

<p>A matrix containing the mean and sd
(plus, possibly quantiles and cdf) of the linear predictors
<i>&eta;</i> in
the model
</p>
</td></tr>
<tr valign="top"><td><code>marginals.linear.predictor</code></td>
<td>

<p>If <code>compute=TRUE</code> in
<code>control.predictor</code>, a list containing the posterior
marginals of the linear predictors <i>&eta;</i> in the model.
</p>
</td></tr>
<tr valign="top"><td><code>summary.fitted.values</code></td>
<td>
<p> A matrix containing the mean and
sd (plus, possibly quantiles and cdf) of the fitted values
<i>g^{-1}(&eta;)</i> obtained by transforming the linear
predictors by the inverse of the link function. This quantity
is only computed if <code>marginals.fitted.values</code> is
computed. Note that if an observation is <code>NA</code> then the
identity link is used. You can manually transform a marginal
using <code>inla.marginal.transform()</code> or set the argument
<code>link</code> in the <code>control.predictor</code>-list;
see <code>?control.predictor</code>
</p>
</td></tr>
<tr valign="top"><td><code>marginals.fitted.values</code></td>
<td>

<p>If <code>compute=TRUE</code> in
<code>control.predictor</code>, a list containing the posterior
marginals  of the fitted values
<i>g^{-1}(&eta;)</i> obtained by
transforming the linear predictors by the inverse of the link
function.
Note that if an observation is <code>NA</code> then the
identity link is used. You can manually transform a marginal
using <code>inla.marginal.transform()</code> or set the argument
<code>link</code> in the <code>control.predictor</code>-list;
see <code>?control.predictor</code>
</p>
</td></tr>
<tr valign="top"><td><code>summary.lincomb</code></td>
<td>

<p>If <code>lincomb != NULL</code> a list of
matrices containing the mean and sd (plus, possibly quantiles
and cdf) of all linear combinations defined.  </p>
</td></tr>
<tr valign="top"><td><code>marginals.lincomb</code></td>
<td>

<p>If <code>lincomb != NULL</code> a list of
posterior marginals of all linear combinations defined.  </p>
</td></tr>
<tr valign="top"><td><code>selection</code></td>
<td>
<p>Provide the approximated joint
distribution for the <code>selection</code></p>
</td></tr>
<tr valign="top"><td><code>dic</code></td>
<td>

<p>If <code>dic</code>=<code>TRUE</code> in <code>control.compute</code>, the
deviance information criteria and effective number of parameters,
otherwise <code>NULL</code>
</p>
</td></tr>
<tr valign="top"><td><code>cpo</code></td>
<td>

<p>If <code>cpo</code>=<code>TRUE</code> in <code>control.compute</code>, a list
of three elements: <code>cpo$cpo</code> are the values of the conditional
predictive ordinate (CPO), <code>cpo$pit</code> are the values of the
probability integral transform (PIT) and <code>cpo$failure</code>
indicates whether some assumptions are violated. In short, if
cpo$failure[i] &gt; 0 then some assumption is violated, the higher the
value (maximum 1) the more seriously.
</p>
</td></tr>
<tr valign="top"><td><code>po</code></td>
<td>

<p>If <code>po</code>=<code>TRUE</code> in <code>control.compute</code>, a list
of one elements: <code>po$po</code> are the values of the
predictive ordinate (CPO) (<code>pi(yi|y)</code>)
</p>
</td></tr>
<tr valign="top"><td><code>waic</code></td>
<td>

<p>If <code>waic</code>=<code>TRUE</code> in <code>control.compute</code>, a list
of two elements: <code>waic$waic</code> is the Watanabe-Akaike information criteria,  and
<code>waic$p.eff</code> is the estimated effective number of parameters
</p>
</td></tr>
<tr valign="top"><td><code>mlik</code></td>
<td>

<p>If <code>mlik</code>=<code>TRUE</code> in <code>control.compute</code>, the
log marginal likelihood of the model (using two different estimates), otherwise <code>NULL</code>
</p>
</td></tr>
<tr valign="top"><td><code>neffp</code></td>
<td>

<p>Expected effective number of parameters in the model. The
standard deviation of the expected number of parameters and the
number of replicas for parameter are also returned</p>
</td></tr>
<tr valign="top"><td><code>mode</code></td>
<td>

<p>A list of two elements: <code>mode$theta</code> is the
computed mode of the hyperparameters and <code>mode$x</code> is the
mode of the latent field given the modal value of the
hyperparamters.
</p>
</td></tr>
<tr valign="top"><td><code>call</code></td>
<td>

<p>The matched call.</p>
</td></tr>
<tr valign="top"><td><code>formula</code></td>
<td>

<p>The formula supplied</p>
</td></tr>
<tr valign="top"><td><code>nhyper</code></td>
<td>

<p>The number of hyperparameters in the model</p>
</td></tr>
<tr valign="top"><td><code>cpu.used</code></td>
<td>

<p>The cpu time used by the <code>inla</code> function</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Havard Rue <a href="mailto:hrue@r-inla.org">hrue@r-inla.org</a> and Sara Martino</p>


<h3>References</h3>

<p>Rue, H. and Martino, S. and Chopin, N. (2009)
<em>Approximate Bayesian Inference for latent Gaussian models
using Integrated Nested Laplace Approximations, JRSS-series B
(with discussion)</em>, vol 71, no 2, pp 319-392.
Rue, H and Held, L. (2005) <em>Gaussian Markov Random Fields
- Theory and Applications</em> Chapman and Hall</p>


<h3>See Also</h3>

<p><code><a href="../../INLA/help/f.html">f</a></code>,
<code><a href="../../INLA/help/inla.hyperpar.html">inla.hyperpar</a></code> </p>


<h3>Examples</h3>

<pre>
 ## Not run: 
 ##See the web page \url{www.r-inla.org} for a series of worked out examples
 
## End(Not run)
 </pre>

<hr /><div style="text-align: center;">[Package <em>INLA</em> version 22.02.16-2 <a href="00Index.html">Index</a>]</div>
</div></body></html>
