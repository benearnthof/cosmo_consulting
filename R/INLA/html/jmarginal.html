<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Sample, transform and evaluate from a joint marginal...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for joint.marginal {INLA}"><tr><td>joint.marginal {INLA}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Sample, transform and evaluate from a joint marginal approximation</h2>

<h3>Description</h3>

<p>Sample, transform and evalue from from a joint marginal approximation
as returned using argument <code>selection</code> in <code>inla</code>.
</p>


<h3>Usage</h3>

<pre>
 inla.rjmarginal(n, jmarginal, constr)
 inla.rjmarginal.eval(fun, samples, ...)
 inla.tjmarginal(jmarginal, A)
 inla.1djmarginal(jmarginal)
 </pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>n</code></td>
<td>
<p>The number of samples</p>
</td></tr>
<tr valign="top"><td><code>jmarginal</code></td>
<td>
<p>A marginal object given  either by a <code>inla</code> object
or <code>result$selection</code></p>
</td></tr>
<tr valign="top"><td><code>constr</code></td>
<td>
<p>Optional linear constraints;
see <code>?INLA::f</code> and argument <code>extraconstr</code></p>
</td></tr>
<tr valign="top"><td><code>fun</code></td>
<td>
<p>A function which is evaluated for each sample, similar to
<code>inla.posterior.sample.eval</code>: please see the documentation
for this functions for details. </p>
</td></tr>
<tr valign="top"><td><code>samples</code></td>
<td>
<p>The samples, as in the form of the output from <code>inla.rjmarginal</code></p>
</td></tr>
<tr valign="top"><td><code>A</code></td>
<td>
<p>A matrix used for the linear combination</p>
</td></tr>
</table>


<h3>Value</h3>


<p>THESE FUNCTIONS ARE EXPERIMENTAL FOR THE MOMENT (JULY 2020)
</p>
<p><code>inla.rjmarginal</code> returns a list with the samples in <code>samples</code>
(matrix) and the corresponding log-densities
in <code>log.density</code> (vector). Each column in <code>samples</code> contains one sample.
</p>
<p><code>inla.rjmarginal.eval</code> returns a matrix, where each row is the (vector) function
evaluated at each sample.
</p>
<p><code>inla.tjmarginal</code> returns a <code>inla.jmarginal</code>-object of the linear combination
defined by the matrix <code>A</code>.
</p>
<p><code>inla.1djmarginal</code> return the marginal densities from a joint approximation.
</p>


<h3>Author(s)</h3>

<p>Cristian Chiuchiolo and Havard Rue <a href="mailto:hrue@r-inla.org">hrue@r-inla.org</a></p>


<h3>See Also</h3>

<p><code><a href="../../INLA/help/inla.html">inla</a></code></p>


<h3>Examples</h3>

<pre>
 n = 10
 x = 1+rnorm(n)
 xx = 3 + rnorm(n)
 y = 1 + x + xx + rnorm(n)
 selection = list(xx=1, Predictor = 3:4, x=1)
 r = inla(y ~ 1 + x + xx,
          data = data.frame(y, x, xx),
          selection = selection)
 ns = 100
 xx = inla.rjmarginal(ns, r)

 print(cbind(mean = r$selection$mean, sample.mean = rowMeans(xx$samples)))
 print("cov matrix")
 print(round(r$selection$cov.matrix, dig=3))
 print("sample cov matrix")
 print(round(cov(t(xx$samples)), dig=3))

 skew = function(z) mean((z-mean(z))^3)/var(z)^1.5
 print(round(cbind(skew = r$selection$skewness,
                   sample.skew = apply(xx$sample, 1, skew)), dig=3))

 ## illustrating the eval function
 n = 10
 x = rnorm(n)
 eta = 1 + x
 y = eta + rnorm(n, sd=0.1)
 selection = list(x = 1, Predictor = c(1, 2, 4, 5),  '(Intercept)' = 1)
 r = inla(y ~ 1 + x,
          data = data.frame(y, x),
          selection = selection)
 xx = inla.rjmarginal(100,  r)
 xx.eval = inla.rjmarginal.eval(function() c(x, Predictor, Intercept),  xx)
 print(cbind(xx$samples[, 1]))
 print(cbind(xx.eval[, 1]))

 constr &lt;- list(A = matrix(1, ncol = n, nrow = 1), e = 1)
 x &lt;- inla.rjmarginal(10, r, constr = constr)

 A &lt;- matrix(rnorm(n^2), n, n)
 b &lt;- inla.tjmarginal(r, A)
 b.marg &lt;- inla.1djmarginal(b)
</pre>

<hr /><div style="text-align: center;">[Package <em>INLA</em> version 22.02.16-2 <a href="00Index.html">Index</a>]</div>
</div></body></html>
